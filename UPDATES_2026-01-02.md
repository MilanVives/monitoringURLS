# Updates Applied - January 2, 2026

## Changes Implemented:

### 1. Website Title Update ✅
**Changes:**
- Updated main dashboard title from "Node JS Project URL Status Dashboard" to "UptimeService Status Dashboard"
- Changed in both `<title>` tag and main header

**Files Modified:**
- `public/index.html`

---

### 2. Dynamic CSV Column Mapping ✅
**Feature:** Admin can now manually configure which CSV columns map to which data fields.

**New Features:**
- ✅ CSV mapping stored in MongoDB (persistent across restarts)
- ✅ Auto-detection of CSV headers with preview
- ✅ Visual CSV preview showing first 5 rows with column numbers
- ✅ Manual mapping editor with intuitive UI
- ✅ Support for different CSV separators (semicolon, comma, tab, etc.)
- ✅ Multiple mapping profiles (can save and switch between different mappings)

**How to Use:**

1. **Access Admin Panel:** `http://localhost:3000/admin.html`
2. **Click "Edit Column Mapping"** in the CSV Column Mapping section
3. **Modal opens showing:**
   - CSV Preview (first 5 rows with column numbers)
   - Input fields for each required data field
   - Column number for: Name, URL, Email, GitHub, Documentation, Submission Time

4. **Configure Mapping:**
   - Column numbers start at 0
   - Default mapping:
     - Name: Column 4
     - URL: Column 8
     - Email: Column 3
     - GitHub: Column 7
     - Documentation: Column 9
     - Submission Time: Column 2

5. **Save and Reload:**
   - Click "Save Mapping"
   - Upload new CSV file (will use new mapping automatically)

**API Endpoints Added:**
- `GET /api/admin/csv-mapping` - Get active mapping configuration
- `GET /api/admin/csv-mappings` - List all saved mappings
- `POST /api/admin/csv-mapping` - Create new mapping
- `PUT /api/admin/csv-mapping/:id` - Update existing mapping
- `DELETE /api/admin/csv-mapping/:id` - Delete mapping
- `GET /api/admin/csv-preview` - Preview CSV with column numbers

**Files Created:**
- `models/CSVMapping.js` - MongoDB schema for CSV mappings

**Files Modified:**
- `services/csvService.js` - Updated to use dynamic column mapping
- `server.js` - Added CSV mapping API endpoints
- `public/admin.html` - Added mapping editor UI and preview functionality

---

## Benefits:

1. **Flexibility:** Works with any CSV format, not just the default one
2. **No Code Changes:** Admin can adapt to new CSV formats without developer intervention
3. **Visual Feedback:** CSV preview helps identify correct column numbers
4. **Persistent:** Mappings saved in database and survive restarts
5. **Multiple Formats:** Can save different mappings for different CSV sources

---

## Example Usage Scenarios:

### Scenario 1: CSV with Different Column Order
If your CSV has columns in a different order:
1. Upload the CSV file
2. Click "Preview CSV" to see column numbers
3. Click "Edit Column Mapping"
4. Update column numbers based on preview
5. Save mapping
6. Re-import CSV to apply new mapping

### Scenario 2: Different CSV Format
If you receive CSV from a different source:
1. Click "Edit Column Mapping"
2. Create new mapping with appropriate name (e.g., "Alternative Format")
3. Set correct column numbers
4. Change separator if needed (e.g., comma instead of semicolon)
5. Save mapping (becomes active immediately)

---

## Testing:

```bash
# 1. Access dashboard
open http://localhost:3000

# 2. Verify title changed
curl -s http://localhost:3000/ | grep "UptimeService"

# 3. Access admin panel
open http://localhost:3000/admin.html

# 4. Test CSV mapping API (after login)
curl -b cookies.txt http://localhost:3000/api/admin/csv-mapping

# 5. Test CSV preview
curl -b cookies.txt http://localhost:3000/api/admin/csv-preview
```

---

## Configuration Options:

The mapping configuration supports:
- **Column Numbers:** 0-indexed column positions
- **Separator:** Any character (`;`, `,`, `\t`, `|`, etc.)
- **Skip Lines:** Number of header rows to skip (default: 1)
- **Active Flag:** Only one mapping can be active at a time

---

## Future Enhancements:

Potential improvements for later:
- Auto-detect column mapping based on header names
- Import/export mapping configurations
- Mapping templates for common formats
- Column validation and data preview before import

---

## Important Notes:

⚠️ **After changing mapping:**
- You must re-upload/reload the CSV file for changes to take effect
- Existing servers in database are not affected
- Only new CSV imports will use the updated mapping

✅ **Best Practice:**
- Always use "Preview CSV" before editing mapping
- Test with a small CSV file first
- Keep mapping names descriptive
- Document your mapping choices for team members

